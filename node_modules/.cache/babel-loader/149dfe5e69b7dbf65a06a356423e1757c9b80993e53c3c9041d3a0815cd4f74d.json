{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rsahani/Documents/RAHUL/PROJECT V-Anime/v-anime1/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/rsahani/Documents/RAHUL/PROJECT V-Anime/v-anime1/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/rsahani/Documents/RAHUL/PROJECT V-Anime/v-anime1/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import'../main.css';import MY_Navbar2 from'../components/Navbar_2';import ThemeToggleButton from'../components/toggleTheme';import'./WatchAnime.css';import{Link,useLocation}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Watch(){var location=useLocation();var _useState=useState(\"Naruto\"),_useState2=_slicedToArray(_useState,2),Query=_useState2[0],setQuery=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),animeList=_useState4[0],setAnimeList=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),WatchUrl=_useState6[0],setWatchUrl=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),TotalEP=_useState8[0],setTotalEP=_useState8[1];var _useState9=useState(1),_useState10=_slicedToArray(_useState9,2),EP=_useState10[0],setEP=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isDarkMode=_useState12[0],setIsDarkMode=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),dataLoaded=_useState14[0],setDataLoaded=_useState14[1];var _useState15=useState(1),_useState16=_slicedToArray(_useState15,2),page=_useState16[0],setPage=_useState16[1];var episodesPerPage=50;var startIndex=(page-1)*episodesPerPage;var endIndex=startIndex+episodesPerPage;var handlePrevPage=function handlePrevPage(){if(page>1){setPage(page-1);}};var handleNextPage=function handleNextPage(){var numPages=Math.ceil(animeList.episodes.length/episodesPerPage);if(page<numPages){setPage(page+1);}};var handleThemeToggle=function handleThemeToggle(){setIsDarkMode(!isDarkMode);};function handleChange(que){setQuery(que);}var handleLinkClick=function handleLinkClick(episodeId){fetchAnime(episodeId);};var fetchEpisodes=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(query){var response,data,animeList,TotalEP;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://api.consumet.org/anime/gogoanime/info/\".concat(query));case 2:response=_context.sent;_context.next=5;return response.json();case 5:data=_context.sent;animeList=data;setAnimeList(animeList);_context.next=10;return animeList.totalEpisodes;case 10:TotalEP=_context.sent;setTotalEP(TotalEP);console.log(animeList);console.log(\"TITLE: \"+animeList.title);console.log(\"Total Ep: \"+TotalEP);console.log(\"Episode : \"+animeList.episodes[0].id);setEP(animeList.episodes[0].id);setDataLoaded(true);case 18:case\"end\":return _context.stop();}},_callee);}));return function fetchEpisodes(_x){return _ref.apply(this,arguments);};}();var fetchAnime=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(Que,Epi_No){var syntext,servers,server_data,_WatchUrl,response,_server_data,_WatchUrl2;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:syntext=Que+\"-\"+Epi_No;console.log(\"TEXT\"+syntext);if(!Epi_No){_context2.next=16;break;}_context2.next=5;return fetch(\"https://api.consumet.org/anime/gogoanime/servers/\".concat(syntext));case 5:servers=_context2.sent;_context2.next=8;return servers.json();case 8:server_data=_context2.sent;console.log(\"servers: \");console.log(server_data);_WatchUrl=server_data[2].url;setWatchUrl(_WatchUrl);setDataLoaded(true);_context2.next=26;break;case 16:_context2.next=18;return fetch(\"https://api.consumet.org/anime/gogoanime/servers/\".concat(Que));case 18:response=_context2.sent;_context2.next=21;return response.json();case 21:_server_data=_context2.sent;_WatchUrl2=_server_data[2].url;setWatchUrl(_WatchUrl2);console.log(_WatchUrl2);setDataLoaded(true);case 26:case\"end\":return _context2.stop();}},_callee2);}));return function fetchAnime(_x2,_x3){return _ref2.apply(this,arguments);};}();// const formattedQuery = Query.replace(/\\s+/g, \"-\").toLowerCase(); \n// console.log(formattedQuery); // \"attack-on-titan\"\nuseEffect(function(){var Query=new URLSearchParams(location.search).get(\"query\");var EP=new URLSearchParams(location.search).get(\"ep\");setQuery(Query);setEP(EP);fetchEpisodes(Query);if(EP){console.log(\"C EP: \"+EP);fetchAnime(Query,EP);}console.log(animeList);},[]);if(!dataLoaded){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}else{return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\" \",animeList.title]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(e){return handleChange(e.target.value);}}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",onClick:function onClick(){return fetchEpisodes(Query);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"pagination\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handlePrevPage,children:\"Prev\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Page \",page,\" of \",Math.ceil(animeList.episodes.length/episodesPerPage)]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleNextPage,children:\"Next\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:animeList.episodes.slice(startIndex,endIndex).map(function(episode,index){return/*#__PURE__*/_jsx(\"div\",{className:\"episode\",children:/*#__PURE__*/_jsx(Link,{className:\"link\"// to={`/watch/${episode.id}`}\n,to:{pathname:'/watch',search:\"?query=\".concat(Query,\"&ep=\").concat(episode.id)},onClick:function onClick(){return handleLinkClick(episode.id);},children:index})},index);})}),/*#__PURE__*/_jsx(\"div\",{className:\"video\",children:/*#__PURE__*/_jsx(\"iframe\",{src:WatchUrl,width:\"1080px\",height:\"600px\"})})]})]});}}export default Watch;","map":{"version":3,"names":["React","useState","useEffect","MY_Navbar2","ThemeToggleButton","Link","useLocation","Watch","location","Query","setQuery","animeList","setAnimeList","WatchUrl","setWatchUrl","TotalEP","setTotalEP","EP","setEP","isDarkMode","setIsDarkMode","dataLoaded","setDataLoaded","page","setPage","episodesPerPage","startIndex","endIndex","handlePrevPage","handleNextPage","numPages","Math","ceil","episodes","length","handleThemeToggle","handleChange","que","handleLinkClick","episodeId","fetchAnime","fetchEpisodes","query","fetch","response","json","data","totalEpisodes","console","log","title","id","Que","Epi_No","syntext","servers","server_data","url","URLSearchParams","search","get","e","target","value","slice","map","episode","index","pathname"],"sources":["/Users/rsahani/Documents/RAHUL/PROJECT V-Anime/v-anime1/src/pages/WatchAnime.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport '../main.css';\nimport MY_Navbar2 from '../components/Navbar_2';\nimport ThemeToggleButton from '../components/toggleTheme';\nimport './WatchAnime.css';\nimport { Link, useLocation } from 'react-router-dom';\n\n\nfunction Watch() {\n    const location = useLocation()\n\n    const [Query, setQuery] = useState(\"Naruto\");\n    const [animeList, setAnimeList] = useState({});\n    const [WatchUrl, setWatchUrl] = useState(\"\");\n\n    const [TotalEP, setTotalEP] = useState(1);\n    const [EP, setEP] = useState(1);\n\n    const [isDarkMode, setIsDarkMode] = useState(false);\n    const [dataLoaded, setDataLoaded] = useState(false);\n\n    const [page, setPage] = useState(1);\n    const episodesPerPage = 50;\n    const startIndex = (page - 1) * episodesPerPage;\n    const endIndex = startIndex + episodesPerPage;\n\n    const handlePrevPage = () => {\n        if (page > 1) {\n            setPage(page - 1);\n        }\n    };\n\n    const handleNextPage = () => {\n        const numPages = Math.ceil(animeList.episodes.length / episodesPerPage);\n        if (page < numPages) {\n            setPage(page + 1);\n        }\n    };\n\n\n    const handleThemeToggle = () => {\n        setIsDarkMode(!isDarkMode);\n    };\n\n    function handleChange(que) {\n        setQuery(que);\n    }\n\n    const handleLinkClick = (episodeId) => {\n        fetchAnime(episodeId);\n    };\n\n\n    const fetchEpisodes = async (query) => {\n        const response = await fetch(`https://api.consumet.org/anime/gogoanime/info/${query}`)\n        const data = await response.json();\n        const animeList = data;\n        setAnimeList(animeList);\n        const TotalEP = await animeList.totalEpisodes;\n        setTotalEP(TotalEP);\n        console.log(animeList);\n        console.log(\"TITLE: \" + animeList.title);\n        console.log(\"Total Ep: \" + TotalEP);\n        console.log(\"Episode : \" + animeList.episodes[0].id);\n        setEP(animeList.episodes[0].id)\n        setDataLoaded(true);\n    };\n\n    const fetchAnime = async (Que, Epi_No) => {\n        let syntext = Que + \"-\" + Epi_No;\n        console.log(\"TEXT\" + syntext);\n        if (Epi_No) {\n            const servers = await fetch(`https://api.consumet.org/anime/gogoanime/servers/${syntext}`)\n            const server_data = await servers.json();\n            console.log(\"servers: \");\n            console.log(server_data);\n            const WatchUrl = server_data[2].url;\n            setWatchUrl(WatchUrl);\n            setDataLoaded(true);\n        } else {\n            const response = await fetch(`https://api.consumet.org/anime/gogoanime/servers/${Que}`)\n            const server_data = await response.json();\n            const WatchUrl = server_data[2].url;\n            setWatchUrl(WatchUrl);\n            console.log(WatchUrl);\n            setDataLoaded(true);\n        }\n    };\n\n\n\n\n    // const formattedQuery = Query.replace(/\\s+/g, \"-\").toLowerCase(); \n    // console.log(formattedQuery); // \"attack-on-titan\"\n\n\n    useEffect(() => {\n        const Query = new URLSearchParams(location.search).get(\"query\");\n        const EP = new URLSearchParams(location.search).get(\"ep\");\n\n        setQuery(Query);\n        setEP(EP);\n\n        fetchEpisodes(Query);\n        if (EP) {\n            console.log(\"C EP: \" + EP);\n            fetchAnime(Query, EP);\n        }\n        console.log(animeList);\n    }, []);\n\n    if (!dataLoaded) {\n        return <div>Loading...</div>;\n    } else {\n        return (\n            <div className={`app`}>\n                <h1> {animeList.title}</h1>\n                <input type={\"text\"} onChange={e => handleChange(e.target.value)} />\n                <input type={\"submit\"} onClick={() => fetchEpisodes(Query)} />\n                    <div className='pagination'>\n                        <button onClick={handlePrevPage}>Prev</button>\n                        <span>\n                            Page {page} of {Math.ceil(animeList.episodes.length / episodesPerPage)}\n                        </span>\n                        <button onClick={handleNextPage}>Next</button>\n                    </div>\n                <div className='main-content'>\n                <div className='content' >\n\n                    {animeList.episodes.slice(startIndex, endIndex).map((episode, index) => (\n                        <div className='episode' key={index} >\n                            <Link\n                                className='link'\n                                // to={`/watch/${episode.id}`}\n                                to={{\n\n                                    pathname: '/watch',\n                                    search: `?query=${Query}&ep=${episode.id}`\n                                }}\n                                onClick={() => handleLinkClick(episode.id)}\n                            >\n                                {index}\n                            </Link>\n                        </div>\n                    ))}\n\n\n                </div>\n                <div className='video'>\n                    <iframe src={WatchUrl} width={\"1080px\"} height={\"600px\"}></iframe>\n                </div>\n            </div>\n\n\n            </div >\n        );\n    }\n}\n\nexport default Watch;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}